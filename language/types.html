<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Types - DualSub - Documentation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation of the DualSub language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../preface.html">Preface</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Installation</li><li class="chapter-item expanded "><a href="../installation/dualsub.html"><strong aria-hidden="true">1.</strong> Installing DualSub</a></li><li class="chapter-item expanded "><a href="../installation/editor-support.html"><strong aria-hidden="true">2.</strong> Editor Integration</a></li><li class="chapter-item expanded affix "><li class="part-title">The DualSub Language</li><li class="chapter-item expanded "><a href="../language/types.html" class="active"><strong aria-hidden="true">3.</strong> Types</a></li><li class="chapter-item expanded "><a href="../language/terms.html"><strong aria-hidden="true">4.</strong> Terms</a></li><li class="chapter-item expanded "><a href="../language/commands.html"><strong aria-hidden="true">5.</strong> Commands</a></li><li class="chapter-item expanded affix "><li class="part-title">Formal Specification</li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Specification</div></li><li class="chapter-item expanded affix "><li class="part-title">Language Server Features</li><li class="chapter-item expanded "><a href="../features/features.html"><strong aria-hidden="true">7.</strong> LSP Features</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../further-reading.html">Further Reading</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">DualSub - Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ps-tuebingen/dualsub" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/ps-tuebingen/dualsub/edit/main/docs/src/language/types.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="types"><a class="header" href="#types">Types</a></h1>
<h2 id="kinds-and-evaluation-order"><a class="header" href="#kinds-and-evaluation-order">Kinds and Evaluation Order</a></h2>
<p>Most languages choose one evaluation strategy.
Strict languages like OCaml, SML or F# choose a call-by-value (CBV) evaluation strategy, whereas non-strict languages choose either
call-by-name (CBN) or call-by-need.
DualSub is not comitted to either strategy.
Instead, the user can choose between two different evaluation strategies for each type individually.
The two evaluation strategies are:</p>
<table><thead><tr><th>Evaluation Order</th><th>Explanation</th></tr></thead><tbody>
<tr><td>CBV</td><td>Call-by-value</td></tr>
<tr><td>CBN</td><td>Call-by-name</td></tr>
</tbody></table>
<p>The different evaluation strategies are reflected in the kinds of types.
Instead of having only one inhabitated kind, usually written <code>*</code> in the type theory literature, there are several different kinds which classify inhabitated types.
These inhabitated kinds are called &quot;MonoKind&quot;. Currently there are four different MonoKinds, one for each of boxed values of CBV and CBN types, and one for each of the primitive unboxed types.</p>
<table><thead><tr><th>MonoKind</th><th>Explanation</th></tr></thead><tbody>
<tr><td>CBV</td><td>The kind of boxed CBV types</td></tr>
<tr><td>CBN</td><td>The kind of boxed CBN types</td></tr>
<tr><td>I64Rep</td><td>The kind of the unboxed #I64 type</td></tr>
<tr><td>F64Rep</td><td>The kind of the unboxed #F64 type</td></tr>
</tbody></table>
<p>Higher kinds are the kinds given to type constructors.
Since the only available type constructors in DualSub construct CBV or CBN types, they follow the following restricted grammar.
Each argument in a PolyKind has a variance, either <code>+</code> for covariant arguments or <code>-</code> for contravariant arguments, a type variable <code>a</code>, and a
MonoKind of type type variable, <code>mk</code>.</p>
<table><thead><tr><th>PolyKind</th><th>Explanation</th></tr></thead><tbody>
<tr><td>(+-a : mk)* -&gt; eo</td><td>Polykind</td></tr>
<tr><td>CBV</td><td>Syntactic sugar for () -&gt; CBV</td></tr>
<tr><td>CBN</td><td>Syntactic sugar for () -&gt; CBN</td></tr>
</tbody></table>
<h2 id="builtin-types"><a class="header" href="#builtin-types">Builtin Types</a></h2>
<p>There are two builtin types which correspond to numeric types supported by most modern architectures.
The builtin types are given in the following table.</p>
<table><thead><tr><th>Type</th><th>Kind</th><th>Explanation</th></tr></thead><tbody>
<tr><td>#I64</td><td>I64Rep</td><td>Unboxed signed 64-Bit integers</td></tr>
<tr><td>#F64</td><td>F64Rep</td><td>Unboxed 64-Bit precision floating point numbers</td></tr>
</tbody></table>
<p>Each Builtin type has its own kind, which reflects the fact that these types are unboxed.
Since they are unboxed, it is in general not possible to apply a polymorphic function to an argument of a builtin type.
The standard library provides wrappers in the <code>I64.ds</code> and <code>F64.ds</code> modules which provide the boxed variants of the builtin unboxed types.</p>
<h2 id="nominal-types"><a class="header" href="#nominal-types">Nominal Types</a></h2>
<p>DualSub has two different variants of nominal types; nominal data types and nominal codata types.</p>
<h4 id="nominal-data-types"><a class="header" href="#nominal-data-types">Nominal Data Types</a></h4>
<p>Nominal data types are declared using the <code>data</code> keyword.
For example, the following two declarations declare Booleans and Peano natural numbers, respectively.</p>
<pre><code>data Bool : CBV { True, False };

data Nat : CBV { Zero, Succ(Nat) };
</code></pre>
<p>Note that we have to indicate the evaluation order we want to use for that type.
We can also use nominal data types to declare the unit and void type.</p>
<pre><code>data Unit : CBV { MkUnit };
data Void : CBV {};
</code></pre>
<p>When we declare parameterized data types, we have to declare both the kind of the type parameter, and its variance.
For example, we can declare the type of lists of CBV types.</p>
<pre><code>data List : (+a : CBV) -&gt; CBV {
    Nil,
    Cons(a, List(a))
};
</code></pre>
<p>In order for the algebraic subtyping approach to work, all type parameters have to be either covariant or contravariant.
It currently isn't possible to use invariant type parameters, but such a feature might be added as syntactic sugar at a future point.</p>
<h4 id="nominal-codata-types"><a class="header" href="#nominal-codata-types">Nominal Codata Types</a></h4>
<p>Codata types are introduced using the <code>codata</code> keyword.</p>
<p>One of the standard examples of a codata type is the example of an infinite stream of natural numbers, called <code>NatStream</code>.
A stream has two possible observations, <code>Head</code> and <code>Tail</code>, which we call the destructors of the codata type.
The destructor <code>Head</code> returns the first element of the stream, and the destructor <code>Tail</code> returns the remainder of the stream.</p>
<pre><code>codata NatStream : CBN {
    Head[Nat], 
    Tail[NatStream]
};
</code></pre>
<p>Codata types can also be parameterized, similar to the List example of the previous section.</p>
<pre><code>codata Stream : (+a : CBV) -&gt; CBN {
    Head[a],
    Tail[Stream(a)]
};
</code></pre>
<p>Codata types make it possible to define the function type, instead of having a builtin function type like most functional programming languages.
The declaration of the function type looks like this.</p>
<pre><code>codata Fun : (-a : CBV, +b CBV) -&gt; CBN {
    Ap(a)[b]
}
</code></pre>
<h2 id="structural-types"><a class="header" href="#structural-types">Structural Types</a></h2>
<p>Nominal data and codata types define a new type together with all of its constructors (resp. destructors).
But sometimes it is more useful to have a more structural type, where we can introduce new constructors and destructors at arbitrary places in the program.
These types are often called extensible variants and records, and DualSub supports them in the form of structural data and codata types.</p>
<p>Structural data types are similar to polymorphic variants in, for example, OCaml.
Structural codata types are similar to extensible records in, for example, Purescript.
In distinction to those systems, constructors and destructors of structural data and codata types have to be declared in DualSub before they can be used.
This approach has the following benefits:</p>
<ul>
<li>It becomes possible to identify typos when using structural data and codata.</li>
<li>The structural constructors and destructors can be documented using a docstring, which can be shown on hover.</li>
</ul>
<h4 id="structural-data-types"><a class="header" href="#structural-data-types">Structural Data Types</a></h4>
<p>A constructor of a structural data type is introduced with a <code>constructor</code> declaration.</p>
<pre><code>constructor True : CBV;
</code></pre>
<p>When occuring in types, structural data types are written using angle brackets.
The structural encoding of booleans, for example, looks like this:</p>
<pre><code>&lt; True, False &gt;
</code></pre>
<p>whereas the structural encoding of Peano natural numbers looks like this</p>
<pre><code>mu a. &lt; Z , S(a)&gt;
</code></pre>
<h4 id="structural-codata-types"><a class="header" href="#structural-codata-types">Structural Codata Types</a></h4>
<p>A destructor of a structural codata type is introduced with a <code>destructor</code> declaration.</p>
<pre><code>destructor Ap(CBV)[CBN] : CBN;
</code></pre>
<p>Structural codata types are written using braces. The structural encoding of NatStreams, for example, are written as follows:</p>
<pre><code>mu a. { Head[Nat], Tail[a] }
</code></pre>
<h2 id="structural-refinement-types"><a class="header" href="#structural-refinement-types">Structural Refinement Types</a></h2>
<p>Structural refinement types are a novel idea in DualSub which combine features from both nominal and structural types.
They are declared similarly to nominal types, but use the additional keyword <code>refinement</code> in front of the declaration</p>
<pre><code>refinement data Bool : CBV { True, False };
refinement codata NatStream : CBN {
    Head[Nat],
    Tail[NatStream]
};
</code></pre>
<p>The syntax for refinement types is very similar to the syntax for structural data and codata types, but the refined type is indicated by a vertical pipe in front of the constructors/destructors.
The four possible refinements of the boolean type, for example, are written like this:</p>
<pre><code>&lt; Bool | True, False &gt;
&lt; Bool | True &gt;
&lt; Bool | False &gt;
&lt; Bool | &gt;
</code></pre>
<p>And a refinement of the codata type of NatStream is written like this:</p>
<pre><code>{ NatStream | Head[Nat] }
</code></pre>
<h2 id="lattice-types"><a class="header" href="#lattice-types">Lattice Types</a></h2>
<p>DualSub uses subtyping, and some of the operations of the subtyping lattice are available in the surface syntax.
In particular, unions and intersections, as well as the top and bottom elements of the subtyping lattice can be used in types.</p>
<table><thead><tr><th>Type</th><th>Explanation</th></tr></thead><tbody>
<tr><td>Top</td><td>The top element of the subtyping lattice</td></tr>
<tr><td>Bot</td><td>The bottom element of the subtyping lattice</td></tr>
<tr><td>S \/ T</td><td>The union of S and T</td></tr>
<tr><td>S /\ T</td><td>The intersection of S and T</td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../installation/editor-support.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../language/terms.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../installation/editor-support.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../language/terms.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
