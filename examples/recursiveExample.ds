prd rec addS := comatch { 'Ap(x,y)[k] =>
                       x
                       >>
                       match { 'Z    => y >> k
                             , 'S(z) => addS >> 'Ap(z,'S(y))[k]
                             }
                   };

def rec addA := comatch { 'Ap(x,y) => match x with { 'Z => y
                                               , 'S(z) => addA.'Ap(z, 'S(y))
					      }
		     };
